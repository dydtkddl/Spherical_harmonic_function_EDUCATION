# hermite_series_solution_logical.py
import streamlit as st
import sympy as sp
import numpy as np
import matplotlib.pyplot as plt
import matplotlib

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ê¸°ë³¸ ì„¤ì •
plt.rcParams["font.family"] = "Malgun Gothic"
plt.rcParams["axes.unicode_minus"] = False
matplotlib.rcParams["figure.dpi"] = 150
st.set_page_config(page_title="Hermite Series Expansion", layout="centered")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.title("ğŸ“ Hermite ë¯¸ë¶„ë°©ì •ì‹ì˜ ê¸‰ìˆ˜í•´ ì „ê°œ (6ì°¨ê¹Œì§€ ìƒì„¸ ê³„ì‚° ë° ì‹œê°í™”)")
st.caption("ì¡°í™”ì§„ë™ìì˜ í•´ì„ìœ¼ë¡œë¶€í„° Hermite ë‹¤í•­ì‹ìœ¼ë¡œ ì´ì–´ì§€ëŠ” ê¸‰ìˆ˜í•´ ìœ ë„")

st.divider()

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.header("1ï¸âƒ£ ê¸‰ìˆ˜í•´ ê°€ì • ë° ëŒ€ì… â€” Frobenius ë°©ë²•ì˜ ìˆ˜í•™ì  ê·¼ê±°")

st.markdown(r"""
Hermite ë¯¸ë¶„ë°©ì •ì‹ì€ ì–‘ì ì¡°í™”ì§„ë™ìì˜ SchrÃ¶dinger ë°©ì •ì‹ì„  
ë¬´ì°¨ì›í™”í•œ í˜•íƒœë¡œë¶€í„° ë“±ì¥í•˜ë©° ë‹¤ìŒê³¼ ê°™ë‹¤:

$$
H''(y) - 2yH'(y) + \lambda H(y) = 0, \quad (\lambda = \alpha - 1)
$$

ì´ë•Œ \( H(y) \)ëŠ” ë‹¨ìˆœí•œ ì§€ìˆ˜í•¨ìˆ˜ë¡œ í‘œí˜„í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì—,  
**ê³„ìˆ˜ê°€ í•´ì„ì ì¸ ë¯¸ë¶„ë°©ì •ì‹ì˜ ì¼ë°˜í•´ë¥¼ ê¸‰ìˆ˜ë¡œ ê°€ì •í•˜ì—¬ ê·¼ì‚¬í•˜ëŠ” ë°©ë²•**ì„ ì“´ë‹¤.  
ì´ê²ƒì´ ë°”ë¡œ **Frobenius ë°©ë²•(Frobenius Method)** ì´ë‹¤.

---

ğŸ“˜ **Frobenius ë°©ë²•ì˜ í•µì‹¬ ì•„ì´ë””ì–´**

1. ì–´ë–¤ í•´ \(H(y)\)ê°€ ì¡´ì¬í•œë‹¤ë©´, ê·¸ê²ƒì€ ì¼ë°˜ì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ê¸‰ìˆ˜ í˜•íƒœë¡œ í‘œí˜„ ê°€ëŠ¥í•˜ë‹¤:
   $$
   H(y) = \sum_{m=0}^{\infty} a_m y^m
   $$
   ì´ ê¸‰ìˆ˜ëŠ” ê·¼ì‚¬í•´ì´ì ë™ì‹œì— ì‹¤ì œ í•´ì„í•´ì¼ ìˆ˜ ìˆë‹¤.
2. ì´ë¥¼ ë¯¸ë¶„ë°©ì •ì‹ì— ëŒ€ì…í•˜ê³ , **í•­ë³„ë¡œ yì˜ ì°¨ìˆ˜ë¥¼ ì¼ì¹˜**ì‹œì¼œê°€ë©° ê³„ìˆ˜ì‹ì„ ë¹„êµí•˜ë©´,
   ë¯¸ì§€ìˆ˜ ê³„ìˆ˜ë“¤ \(a_m\) ì‚¬ì´ì˜ ê´€ê³„(ì¬ê·€ì‹)ë¥¼ ìœ ë„í•  ìˆ˜ ìˆë‹¤.
3. ëª¨ë“  í•´ê°€ ë‹¤í•­ì‹ìœ¼ë¡œ â€œëë‚˜ì§„â€ ì•Šì§€ë§Œ, íŠ¹ì •í•œ ë§¤ê°œë³€ìˆ˜ ê°’(Î»)ì—ì„œëŠ” ê¸‰ìˆ˜ê°€ ìœ í•œì°¨ì—ì„œ ì¢…ë£Œí•˜ë©°,
   ì´ë•Œ ë°œì‚°í•˜ì§€ ì•ŠëŠ” ë¬¼ë¦¬ì ìœ¼ë¡œ ì˜ë¯¸ ìˆëŠ” í•´ê°€ ë§Œë“¤ì–´ì§„ë‹¤.

---

ë”°ë¼ì„œ í•´ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ê°€ì •í•˜ê³  ê³„ì‚°ì„ ì§„í–‰í•œë‹¤.
""")

st.latex(r"H(y) = \sum_{m=0}^{\infty} a_m y^m")
st.latex(r"H'(y) = \sum_{m=1}^{\infty} ma_m y^{m-1}, \quad H''(y) = \sum_{m=2}^{\infty} m(m-1)a_m y^{m-2}")

st.markdown("ì´ë¥¼ Hermite ë°©ì •ì‹ì— ëŒ€ì…í•˜ë©´, ëª¨ë“  ì°¨ìˆ˜ì— ëŒ€í•´ í•­ë³„ ë¹„êµê°€ ê°€ëŠ¥í•˜ë‹¤:")
st.latex(r"\sum_{m=0}^{\infty}\left[(m+2)(m+1)a_{m+2} - 2ma_m + \lambda a_m\right]y^m = 0")

st.markdown(r"""
ì´ë•Œ ê° í•­ì˜ ê³„ìˆ˜ê°€ 0ì´ì–´ì•¼ ì‹ì´ í•­ìƒ ì„±ë¦½í•˜ë¯€ë¡œ,  
ë‹¤ìŒê³¼ ê°™ì€ **ì¬ê·€ì‹(recursion relation)**ì„ ì–»ëŠ”ë‹¤:
""")
st.latex(r"a_{m+2} = \frac{2m - \lambda}{(m+1)(m+2)}a_m")

st.info("ì´ ì¬ê·€ì‹ì€ Hermite ê¸‰ìˆ˜ì˜ ì „ì²´ êµ¬ì¡°ë¥¼ ê²°ì •í•˜ëŠ” í•µì‹¬ì‹ì´ë‹¤.")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.header("2ï¸âƒ£ ì§ìˆ˜í•­ Â· í™€ìˆ˜í•­ ì „ê°œ ë° ìœ í•œ ì¡°ê±´ â€” ê¸‰ìˆ˜ì˜ ë¶„ë¦¬ì™€ ì–‘ìí™”ì˜ ì‹œì‘")

st.markdown(r"""
ìœ„ì˜ ì¬ê·€ì‹ì€ \(a_{m+2}\)ê°€ \(a_m\)ì—ë§Œ ì˜ì¡´í•œë‹¤.  
ì¦‰, ê³„ìˆ˜ê°€ ë‘ ì¹¸ì”© ê±´ë„ˆë›°ë©° ì—°ê²°ë˜ë¯€ë¡œ, ì§ìˆ˜í•­ê³¼ í™€ìˆ˜í•­ì´ ì™„ì „íˆ ë¶„ë¦¬ëœë‹¤.

- ì§ìˆ˜í•­ ì‹œë¦¬ì¦ˆ: \(a_0, a_2, a_4, \dots\)
- í™€ìˆ˜í•­ ì‹œë¦¬ì¦ˆ: \(a_1, a_3, a_5, \dots\)

ì´ëŠ” ìˆ˜í•™ì ìœ¼ë¡œ \(H(y)\)ê°€ **ì§í•¨ìˆ˜ì™€ í™€í•¨ìˆ˜ì˜ ë…ë¦½ì  ì„ í˜•ê²°í•©**ì„ì„ ì˜ë¯¸í•˜ë©°,  
ì–‘ì ì¡°í™”ì§„ë™ìì˜ í•´ê°€ ì§ìˆ˜/í™€ìˆ˜ ëŒ€ì¹­ìœ¼ë¡œ êµ¬ë¶„ë˜ëŠ” ì´ìœ ì´ê¸°ë„ í•˜ë‹¤.
""")

st.markdown("### ğŸ”¹ Case 1: ì§ìˆ˜í•­ ì „ê°œ (í™€ìˆ˜í•­ \(a_1 = 0\))")
st.latex(r"a_{m+2} = \frac{2m - \lambda}{(m+1)(m+2)} a_m")

st.markdown("ì§ì ‘ ëª‡ í•­ ê³„ì‚°í•´ë³´ë©´:")
st.latex(r"""
\begin{aligned}
a_2 &= -\frac{\lambda}{2}a_0, \\
a_4 &= \frac{\lambda(\lambda - 4)}{24}a_0, \\
a_6 &= -\frac{\lambda(\lambda - 8)(\lambda - 4)}{720}a_0
\end{aligned}
""")

st.markdown("### ğŸ”¹ Case 2: í™€ìˆ˜í•­ ì „ê°œ (ì§ìˆ˜í•­ \(a_0 = 0\))")
st.latex(r"""
\begin{aligned}
a_3 &= \frac{(2 - \lambda)}{6}a_1, \\
a_5 &= \frac{(\lambda - 6)(\lambda - 2)}{120}a_1, \\
a_7 &= -\frac{(\lambda - 10)(\lambda - 6)(\lambda - 2)}{5040}a_1
\end{aligned}
""")

st.markdown(r"""
ì§ìˆ˜í•­ ê¸‰ìˆ˜ì™€ í™€ìˆ˜í•­ ê¸‰ìˆ˜ëŠ” ì„œë¡œ ë…ë¦½ì ì´ì§€ë§Œ,  
ë‘˜ ë‹¤ ë¬´í•œíˆ ì´ì–´ì§ˆ ê²½ìš° ì§€ìˆ˜í•¨ìˆ˜ \(e^{y^2}\)ë³´ë‹¤ ë¹ ë¥´ê²Œ ë°œì‚°í•œë‹¤.  
ë”°ë¼ì„œ ì „ì²´ íŒŒë™í•¨ìˆ˜ \( \psi(y) = H(y)e^{-y^2/2} \)ê°€  
ì •ê·œí™”ë˜ì§€ ëª»í•˜ê³  ë¬¼ë¦¬ì ìœ¼ë¡œ ë¬´ì˜ë¯¸í•´ì§„ë‹¤.

ì´ ë¬¸ì œë¥¼ ë§‰ìœ¼ë ¤ë©´ ê¸‰ìˆ˜ê°€ ì–´ë–¤ ì°¨ìˆ˜ì—ì„œ ë°˜ë“œì‹œ ëë‚˜ì•¼ í•œë‹¤.  
ì¦‰, **ìœ í•œ ë‹¤í•­ì‹ ì¡°ê±´**ì´ í•„ìš”í•˜ë‹¤.
""")

st.latex(r"2m - \lambda = 0 \quad \Rightarrow \quad \lambda = 2n")

st.info("ì´ ì¡°ê±´ì€ ë‹¤í•­ì‹ì´ íŠ¹ì • ì°¨ìˆ˜(n)ì—ì„œ ë©ˆì¶”ê²Œ í•˜ëŠ” 'ì–‘ìí™” ì¡°ê±´'ì´ë‹¤. "
        "ì¦‰, Î»ê°€ ì„ì˜ê°’ì¼ ë•ŒëŠ” ë°œì‚°í•˜ì§€ë§Œ Î»=2nì¼ ë•Œë§Œ ìœ í•œí•œ í•´ê°€ ì¡´ì¬í•œë‹¤.")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.header("3ï¸âƒ£ ì‹¤ì œ ê³„ìˆ˜ ê³„ì‚° ë° ê¸‰ìˆ˜ êµ¬ì¡° í™•ì¸")

lam_val = 6  # Î» = 6 â‡’ n = 3
a_vals = {0: 1}
for m in range(0, 6, 2):
    a_vals[m+2] = (2*m - lam_val)/((m+1)*(m+2)) * a_vals[m]

st.markdown("ì§ìˆ˜í•­ ê³„ì‚° ê²°ê³¼ (Î»=6):")
st.table([[f"a_{k}", round(float(v), 6)] for k, v in a_vals.items()])

st.markdown(r"""
ë”°ë¼ì„œ ì§ìˆ˜í•­ ê¸‰ìˆ˜ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤:
$$
H(y) = a_0(1 - 3y^2 + \frac{3}{2}y^4 - \frac{1}{6}y^6)
$$

ì´ ê¸‰ìˆ˜ì˜ êµ¬ì¡°ëŠ” ì‹¤ì œ Hermite ë‹¤í•­ì‹ \(H_6(y)\)ì™€ ë™ì¼í•œ í˜•íƒœë¥¼ ê°€ì§„ë‹¤.  
ì¦‰, ê¸‰ìˆ˜ ì „ê°œë¥¼ ìœ í•œ ì°¨ìˆ˜ì—ì„œ ë©ˆì¶”ë©´ ìì—°ìŠ¤ëŸ½ê²Œ Hermite ë‹¤í•­ì‹ìœ¼ë¡œ ê·€ê²°ëœë‹¤.
""")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.header("4ï¸âƒ£ Hermite ë‹¤í•­ì‹ìœ¼ë¡œì˜ ì—°ê²° ë° ì‹œê°í™” â€” ê¸‰ìˆ˜í•´ì—ì„œ ê³ ìœ í•¨ìˆ˜ë¡œ")

st.markdown(r"""
Hermite ë‹¤í•­ì‹ì€ ìœ„ ê¸‰ìˆ˜ì˜ ìœ í•œí˜•íƒœë¡œ ì •ì˜ë˜ë©°,  
ì¼ë°˜ì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤:
$$
H_n(y) = (-1)^n e^{y^2} \frac{d^n}{dy^n}(e^{-y^2})
$$

ì´ ì‹ì€ **ìƒì„±í•¨ìˆ˜(Generating Function)**ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³ ë„  
ë¯¸ë¶„ ì—°ì‚°ì„ ë°˜ë³µí•¨ìœ¼ë¡œì¨ ë‹¤í•­ì‹ì„ ì§ì ‘ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤.

---

ê° \(n\)ì— ëŒ€í•´ ê³„ì‚°í•˜ë©´ \(H_0(y)\)ë¶€í„° \(H_6(y)\)ê¹Œì§€ì˜  
ëª¨ë“  Hermite ë‹¤í•­ì‹ì´ ì–»ì–´ì§„ë‹¤.
""")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
y = sp.Symbol("y", real=True)
H = [sp.hermite(n, y) for n in range(7)]
ys = np.linspace(-2, 3, 400)

fig, ax = plt.subplots(figsize=(8, 5), facecolor="#fafafa")
colors = plt.cm.tab10(np.linspace(0, 1, 7))

# ì¤‘ì•™ ì¶•ì„  ê°•ì¡°
ax.axhline(0, color="black", linewidth=1.8, linestyle="-", alpha=0.9)
ax.axvline(0, color="black", linewidth=1.8, linestyle="-", alpha=0.9)

for n, c in zip(range(7), colors):
    f_raw = sp.lambdify(y, H[n], modules=["numpy"])
    yv = np.vectorize(f_raw)(ys)
    ax.plot(ys, yv, color=c, lw=2, label=fr"$H_{n}(y)$")

# ì‹œê°í™” ì„¸ë¶€ ì„¤ì •
ax.set_ylim(-55, 55)
ax.set_xlim(-2, 3)
ax.set_title(r"Hermite ë‹¤í•­ì‹ ($H_0 \sim H_6$)", fontsize=15, fontweight="bold", pad=15)

for spine in ["top", "right"]:
    ax.spines[spine].set_visible(False)
for spine in ["bottom", "left"]:
    ax.spines[spine].set_linewidth(1.2)
    ax.spines[spine].set_color("gray")

ax.set_xlabel(r"$y$ (ì…ë ¥ ë³€ìˆ˜)", fontsize=12, labelpad=10)
ax.set_ylabel(r"$H_n(y)$", fontsize=12, labelpad=10)

ax.tick_params(axis="both", which="major", labelsize=10, width=1.5, length=5)
ax.grid(True, linestyle="--", linewidth=0.7, color="gray", alpha=0.4)

leg = ax.legend(
    title=r"ë‹¤í•­ì‹ ì°¨ìˆ˜ $n$",
    fontsize=9,
    title_fontsize=10,
    loc="upper right",
    frameon=True,
    facecolor="white",
    edgecolor="gray",
)
leg.get_frame().set_alpha(0.85)
leg.get_frame().set_linewidth(0.8)

st.pyplot(fig)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.header("5ï¸âƒ£ Hermite ê¸‰ìˆ˜ì˜ ë¬¼ë¦¬ì  ì˜ë¯¸ â€” ì–‘ìí™”ì™€ ì—ë„ˆì§€ ì¤€ìœ„ì˜ ë“±ì¥")

st.markdown(r"""
ê¸‰ìˆ˜ê°€ ìœ í•œ ì°¨ìˆ˜ì—ì„œ ì¢…ë£Œë˜ë„ë¡ ë§Œë“œëŠ” ì¡°ê±´ \( \lambda = 2n \)ì„  
ë¬¼ë¦¬ì ìœ¼ë¡œ í•´ì„í•˜ë©´, ì´ëŠ” **ì–‘ìí™”(quantization)** ì¡°ê±´ì´ë‹¤.

\[
\lambda = \alpha - 1 = \frac{2E}{\hbar\omega} - 1 = 2n
\]

ì´ë¥¼ ì •ë¦¬í•˜ë©´:
\[
E = \left(n + \frac{1}{2}\right)\hbar\omega
\]

ì´ ê²°ê³¼ëŠ” **ì–‘ì ì¡°í™”ì§„ë™ìì˜ ì—ë„ˆì§€ ì¤€ìœ„ì‹**ì´ë©°,  
ê³ ì „ì  ì—ë„ˆì§€ì˜ ì—°ì†ì„±ì´ ì‚¬ë¼ì§€ê³ ,  
ì •ìˆ˜ ë°°ë¡œ â€œë”±ë”± ëŠê¸´â€ ë¶ˆì—°ì†ì ì¸ ì—ë„ˆì§€ ì¤€ìœ„ë¥¼ ê°–ê²Œ ëœë‹¤.

ì¦‰, ê¸‰ìˆ˜í•´ì˜ ìœ í•œì„±(ìˆ˜í•™ì  ì•ˆì • ì¡°ê±´)ì´  
ë°”ë¡œ ë¬¼ë¦¬ì  ì–‘ìí™”ë¡œ ì—°ê²°ë˜ëŠ” ê²ƒì´ë‹¤.
""")

